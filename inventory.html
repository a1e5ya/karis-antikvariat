<!DOCTYPE html>
<html lang="sv">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lagerhanteringssystem - Karis Antikvariat</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Header will be loaded here -->
    <div id="header-container"></div>

    <!-- Main Content Container -->
    <div class="container my-4">
        <!-- Inventory System -->
        <div id="inventory-system">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>Lagerhanteringssystem</h1>
            </div>

            <!-- Tab Navigation Update -->
            <ul class="nav nav-tabs" id="inventory-tabs">
                <li class="nav-item">
                    <a class="nav-link active" id="search-tab" data-bs-toggle="tab" href="#search">Sök</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="add-tab" data-bs-toggle="tab" href="#add">Lägg till objekt</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="edit-database-tab" data-bs-toggle="tab" href="#edit-database">Redigera
                        databas</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="lists-tab" data-bs-toggle="tab" href="#lists">Listor</a>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content border border-top-0 p-4 bg-white">
                <!-- Search Tab -->
                <div class="tab-pane fade show active" id="search">
                    <div class="row mb-3">
                        <div class="col-12 mb-3">
                            <label for="search-term" class="form-label">Sökterm</label>
                            <input type="text" class="form-control" id="search-term"
                                placeholder="Ange titel, författare eller ID">
                        </div>
                    </div>
                    <div class="row mb-4">
                        <div class="col-md-6 mb-3 mb-md-0">
                            <label for="category-filter" class="form-label">Kategorifilter</label>
                            <select class="form-select" id="category-filter">
                                <option value="any">Alla</option>
                                <option value="bok">Böcker</option>
                                <option value="finlandssvenska">Finlandssvenska författare</option>
                                <option value="lokalhistoria">Lokalhistoria</option>
                                <option value="sjöfart">Sjöfart</option>
                                <option value="barn">Barn- och ungdomsböcker</option>
                                <option value="cd">CD-skivor</option>
                                <option value="vinyl">Vinylskivor</option>
                                <option value="dvd">DVD-filmer</option>
                                <option value="serier">Serier</option>
                                <option value="samlar">Samlarobjekt</option>
                            </select>
                        </div>
                        <div class="col-md-6 d-flex align-items-end">
                            <button id="search-btn" class="btn btn-primary w-100">Sök</button>
                        </div>
                    </div>
                    <div class="table-responsive mt-4">
                        <table class="table table-hover" id="inventory-table">
                            <thead class="table-light">
                                <tr>
                                    <th>ID</th>
                                    <th>Titel</th>
                                    <th>Författare</th>
                                    <th>Kategori</th>
                                    <th>Hylla</th>
                                    <th>Pris</th>
                                    <th>Status</th>
                                    <th>Åtgärder</th>
                                </tr>
                            </thead>
                            <tbody id="inventory-body">
                                <!-- Table content will be loaded by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Add Item Tab -->
                <div class="tab-pane fade" id="add">
                    <div class="row">
                        <!-- Item Image and Upload -->
                        <div class="col-md-4 mb-4">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title mb-3">Objektbild</h5>
                                    <div class="item-image-container mb-3">
                                        <img src="img/src-book.webp" alt="Objektbild" class="img-fluid rounded shadow"
                                            id="new-item-image">
                                    </div>
                                    <div class="mb-3">
                                        <label for="item-image-upload" class="form-label">Ladda upp bild</label>
                                        <input class="form-control" type="file" id="item-image-upload">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Item Details Form -->
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title mb-3">Grundinformation</h5>
                                    <form id="add-item-form">
                                        <div class="row mb-3">
                                            <div class="col-md-8">
                                                <label for="item-title" class="form-label">Titel</label>
                                                <input type="text" class="form-control" id="item-title" name="title"
                                                    required>
                                            </div>
                                            <div class="col-md-4">
                                                <label for="item-status" class="form-label">Status</label>
                                                <select class="form-select" id="item-status" name="status">
                                                    <option value="Tillgänglig" selected>Tillgänglig</option>
                                                    <option value="Reserverad">Reserverad</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="author-first" class="form-label">Författare förnamn</label>
                                                <input type="text" class="form-control" id="author-first"
                                                    name="authorFirstName">
                                            </div>
                                            <div class="col-md-6">
                                                <label for="author-last" class="form-label">Författare efternamn</label>
                                                <input type="text" class="form-control" id="author-last"
                                                    name="authorLastName">
                                            </div>
                                        </div>

                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="item-category" class="form-label">Kategori</label>
                                                <select class="form-select" id="item-category" name="category" required
                                                    onchange="updateNewItemImagePreview()">
                                                    <option value="">Välj kategori</option>
                                                    <option value="Bok - Finlandssvenska">Bok - Finlandssvenska</option>
                                                    <option value="Bok - Lokalhistoria">Bok - Lokalhistoria</option>
                                                    <option value="Bok - Sjöfart">Bok - Sjöfart</option>
                                                    <option value="Bok - Barn/Ungdom">Bok - Barn/Ungdom</option>
                                                    <option value="CD - Musik">CD - Musik</option>
                                                    <option value="Vinyl - Musik">Vinyl - Musik</option>
                                                    <option value="DVD - Film">DVD - Film</option>
                                                    <option value="Serier">Serier</option>
                                                    <option value="Samlarobjekt">Samlarobjekt</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="item-genre" class="form-label">Genre</label>
                                                <select class="form-select" id="item-genre" name="genre">
                                                    <option value="">Välj genre</option>
                                                    <option value="Romaner">Romaner</option>
                                                    <option value="Dikter">Dikter</option>
                                                    <option value="Historia">Historia</option>
                                                    <option value="Biografi">Biografi</option>
                                                    <option value="Rock">Rock</option>
                                                    <option value="Jazz">Jazz</option>
                                                    <option value="Klassisk">Klassisk</option>
                                                    <option value="Barnböcker">Barnböcker</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="row mb-3">
                                            <div class="col-md-4">
                                                <label for="item-price" class="form-label">Pris (€)</label>
                                                <input type="number" step="0.01" class="form-control" id="item-price"
                                                    name="price">
                                            </div>
                                            <div class="col-md-4">
                                                <label for="item-condition" class="form-label">Skick</label>
                                                <select class="form-select" id="item-condition" name="condition">
                                                    <option value="">Välj skick</option>
                                                    <option value="Nyskick">Nyskick</option>
                                                    <option value="Mycket bra">Mycket bra</option>
                                                    <option value="Bra">Bra</option>
                                                    <option value="Acceptabelt">Acceptabelt</option>
                                                </select>
                                            </div>
                                            <div class="col-md-4">
                                                <label for="item-shelf" class="form-label">Hyllplats</label>
                                                <select class="form-select" id="item-shelf" name="shelf">
                                                    <option value="">Välj hylla</option>
                                                    <option value="A1">A1</option>
                                                    <option value="A2">A2</option>
                                                    <option value="B1">B1</option>
                                                    <option value="B2">B2</option>
                                                    <option value="C1">C1</option>
                                                    <option value="C2">C2</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="row mb-3">
                                            <div class="col-md-4">
                                                <label for="item-language" class="form-label">Språk</label>
                                                <select class="form-select" id="item-language" name="language">
                                                    <option value="">Välj språk</option>
                                                    <option value="Svenska">Svenska</option>
                                                    <option value="Finska">Finska</option>
                                                    <option value="Engelska">Engelska</option>
                                                    <option value="Svenska/Engelska">Svenska/Engelska</option>
                                                </select>
                                            </div>
                                            <div class="col-md-4">
                                                <label for="item-year" class="form-label">Utgivningsår</label>
                                                <input type="number" class="form-control" id="item-year" name="year">
                                            </div>
                                            <div class="col-md-4">
                                                <label for="item-publisher" class="form-label">Förlag</label>
                                                <input type="text" class="form-control" id="item-publisher"
                                                    name="publisher">
                                            </div>
                                        </div>

                                        <div class="mb-4">
                                            <label for="item-notes" class="form-label">Anteckningar (synlig för
                                                kunder)</label>
                                            <textarea class="form-control" id="item-notes" name="notes"
                                                rows="3"></textarea>
                                        </div>

                                        <div class="mb-3">
                                            <label for="item-internal-notes" class="form-label">Interna anteckningar
                                                (endast för personal)</label>
                                            <textarea class="form-control" id="item-internal-notes" name="internalNotes"
                                                rows="2"></textarea>
                                        </div>

                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="item-special-price" name="specialPrice">
                                                    <label class="form-check-label" for="item-special-price">
                                                        Speciellt pris
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="item-rare"
                                                        name="rare">
                                                    <label class="form-check-label" for="item-rare">
                                                        Sällsynt objekt
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="d-flex justify-content-end">
                                            <button type="button" id="clear-form-btn"
                                                class="btn btn-outline-secondary me-2">Rensa</button>
                                            <button type="submit" class="btn btn-primary">Lägg till</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Edit Database Tab Content -->
                <div class="tab-pane fade" id="edit-database">
                    <!-- Categories Section -->
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">Kategorier</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex mb-3">
                                <input type="text" class="form-control me-2" id="new-category"
                                    placeholder="Ny kategori">
                                <button class="btn btn-primary" id="add-category-btn">Lägg till</button>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Kategorinamn</th>
                                            <th width="150px">Åtgärder</th>
                                        </tr>
                                    </thead>
                                    <tbody id="categories-list">
                                        <!-- Categories will be loaded dynamically -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Shelf Locations Section -->
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">Hyllplatser</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex mb-3">
                                <input type="text" class="form-control me-2" id="new-shelf" placeholder="Ny hyllplats">
                                <button class="btn btn-primary" id="add-shelf-btn">Lägg till</button>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Hyllnamn</th>
                                            <th width="150px">Åtgärder</th>
                                        </tr>
                                    </thead>
                                    <tbody id="shelves-list">
                                        <!-- Shelves will be loaded dynamically -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Genres Section -->
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">Genrer</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex mb-3">
                                <input type="text" class="form-control me-2" id="new-genre" placeholder="Ny genre">
                                <button class="btn btn-primary" id="add-genre-btn">Lägg till</button>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Genrenamn</th>
                                            <th width="150px">Åtgärder</th>
                                        </tr>
                                    </thead>
                                    <tbody id="genres-list">
                                        <!-- Genres will be loaded dynamically -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Lists Tab -->
                <div class="tab-pane fade" id="lists">
                    <div class="mb-4">
                        <h3 class="mb-3">Speciallistor och batchåtgärder</h3>

                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Vanliga listor</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-primary w-100" id="list-no-price">Objekt utan
                                            pris</button>
                                    </div>
                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-primary w-100" id="list-poor-condition">Objekt i
                                            dåligt skick</button>
                                    </div>
                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-primary w-100" id="list-shelf-check">
                                            <span>Inventering av hylla</span>
                                            <select class="form-select form-select-sm mt-1" id="shelf-selector">
                                                <!-- Will be populated dynamically from database.js -->
                                                <option value="">Välj hylla</option>
                                            </select>
                                        </button>
                                    </div>
                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-primary w-100" id="list-older-than">
                                            <span>Objekt äldre än</span>
                                            <div class="input-group input-group-sm mt-1">
                                                <input type="number" class="form-control" id="year-threshold"
                                                    placeholder="År">
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Avancerad filtrering</h5>
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-md-4 mb-3 mb-md-0">
                                        <label for="list-categories" class="form-label">Kategori</label>
                                        <select class="form-select" id="list-categories" multiple size="3">
                                            <!-- Will be populated dynamically from database.js -->
                                        </select>
                                    </div>

                                    <div class="col-md-4 mb-3 mb-md-0">
                                        <label for="list-genre" class="form-label">Genre</label>
                                        <select class="form-select" id="list-genre">
                                            <!-- Will be populated dynamically from database.js -->
                                            <option value="">Alla genrer</option>
                                        </select>
                                    </div>

                                    <div class="col-md-4 mb-3 mb-md-0">
                                        <label for="list-condition" class="form-label">Skick</label>
                                        <select class="form-select" id="list-condition">
                                            <!-- Will be populated dynamically from database.js -->
                                            <option value="">Alla skick</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-4 mb-3 mb-md-0">
                                        <label for="list-status" class="form-label">Status</label>
                                        <select class="form-select" id="list-status">
                                            <!-- Will be populated dynamically from database.js -->
                                            <option value="all">Alla statusar</option>
                                        </select>
                                    </div>

                                    <div class="col-md-4 mb-3 mb-md-0">
                                        <label class="form-label">Prisintervall</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="price-min"
                                                placeholder="Min €">
                                            <span class="input-group-text">till</span>
                                            <input type="number" class="form-control" id="price-max"
                                                placeholder="Max €">
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <label class="form-label">Datum tillagt</label>
                                        <div class="input-group">
                                            <input type="date" class="form-control" id="date-min">
                                            <span class="input-group-text">till</span>
                                            <input type="date" class="form-control" id="date-max">
                                        </div>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-8 mb-3 mb-md-0">
                                        <label for="list-search" class="form-label">Fritextsökning</label>
                                        <input type="text" class="form-control" id="list-search"
                                            placeholder="Sök i titel, författare eller anteckningar">
                                    </div>

                                    <div class="col-md-4 d-flex align-items-end">
                                        <button class="btn btn-primary w-100" id="apply-filter-btn">
                                            <i class="fas fa-filter me-1"></i> Tillämpa filter
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Batchåtgärder</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-secondary w-100" id="batch-update-price"
                                            disabled>
                                            <i class="fas fa-tag me-1"></i> Uppdatera pris
                                        </button>
                                    </div>

                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-secondary w-100" id="batch-update-status"
                                            disabled>
                                            <i class="fas fa-exchange-alt me-1"></i> Ändra status
                                        </button>
                                    </div>

                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-secondary w-100" id="batch-move-shelf" disabled>
                                            <i class="fas fa-arrows-alt me-1"></i> Flytta till hylla
                                        </button>
                                    </div>

                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-danger w-100" id="batch-delete" disabled>
                                            <i class="fas fa-trash-alt me-1"></i> Ta bort markerade
                                        </button>
                                    </div>
                                </div>

                                <div class="row mt-3">
                                    <div class="col-md-6 mb-2">
                                        <button class="btn btn-outline-primary w-100" id="print-list-btn">
                                            <i class="fas fa-print me-1"></i> Skriv ut lista
                                        </button>
                                    </div>

                                    <div class="col-md-6 mb-2">
                                        <button class="btn btn-outline-primary w-100" id="export-csv-btn">
                                            <i class="fas fa-file-csv me-1"></i> Exportera till CSV
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-hover" id="lists-table">
                            <thead class="table-light">
                                <tr>
                                    <th><input type="checkbox" id="select-all"></th>
                                    <th>ID</th>
                                    <th>Titel</th>
                                    <th>Författare</th>
                                    <th>Kategori</th>
                                    <th>Hylla</th>
                                    <th>Skick</th>
                                    <th>Pris</th>
                                    <th>Status</th>
                                    <th>Tillagd datum</th>
                                </tr>
                            </thead>
                            <tbody id="lists-body">
                                <!-- Table content will be loaded by JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <div class="items-count">
                            <span id="selected-count">0</span> av <span id="total-count">0</span> objekt valda
                        </div>
                        <div class="pagination-controls d-flex align-items-center">
                            <span class="me-2">Sida <span id="current-page">1</span> av <span
                                    id="total-pages">1</span></span>
                            <button class="btn btn-sm btn-outline-secondary me-1" id="prev-page-btn" disabled>«</button>
                            <button class="btn btn-sm btn-outline-secondary" id="next-page-btn" disabled>»</button>
                        </div>
                    </div>
                </div>

                <!-- Batch Update Price Modal -->
                <div class="modal fade" id="updatePriceModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header bg-primary text-white">
                                <h5 class="modal-title">Uppdatera pris</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form id="update-price-form">
                                    <div class="mb-3">
                                        <label class="form-label">Välj prisåtgärd</label>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="radio" name="priceAction"
                                                id="setPrice" value="set" checked>
                                            <label class="form-check-label" for="setPrice">
                                                Sätt fast pris
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="radio" name="priceAction"
                                                id="increasePrice" value="increase">
                                            <label class="form-check-label" for="increasePrice">
                                                Öka med procent
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="radio" name="priceAction"
                                                id="decreasePrice" value="decrease">
                                            <label class="form-check-label" for="decreasePrice">
                                                Minska med procent
                                            </label>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="priceValue" class="form-label">Värde</label>
                                        <div class="input-group">
                                            <input type="number" step="0.01" class="form-control" id="priceValue"
                                                required>
                                            <span class="input-group-text" id="price-unit">€</span>
                                        </div>
                                    </div>

                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="markSpecialPrice">
                                        <label class="form-check-label" for="markSpecialPrice">
                                            Markera som specialpris
                                        </label>
                                    </div>

                                    <div class="d-grid">
                                        <button type="submit" class="btn btn-primary">Uppdatera pris</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Batch Update Status Modal -->
                <div class="modal fade" id="updateStatusModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header bg-primary text-white">
                                <h5 class="modal-title">Uppdatera status</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form id="update-status-form">
                                    <div class="mb-3">
                                        <label for="newStatus" class="form-label">Välj ny status</label>
                                        <select class="form-select" id="newStatus" required>
                                            <!-- Will be populated dynamically from database.js -->
                                            <option value="">Välj status</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label for="statusNotes" class="form-label">Anteckningar</label>
                                        <textarea class="form-control" id="statusNotes" rows="3"
                                            placeholder="Valfri anteckning om statusändringen"></textarea>
                                    </div>

                                    <div class="d-grid">
                                        <button type="submit" class="btn btn-primary">Uppdatera status</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Batch Move Shelf Modal -->
                <div class="modal fade" id="moveShelfModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header bg-primary text-white">
                                <h5 class="modal-title">Flytta till hylla</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form id="move-shelf-form">
                                    <div class="mb-3">
                                        <label for="newShelf" class="form-label">Välj ny hyllplats</label>
                                        <select class="form-select" id="newShelf" required>
                                            <!-- Will be populated dynamically from database.js -->
                                            <option value="">Välj hylla</option>
                                        </select>
                                    </div>

                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle me-2"></i> Detta kommer att flytta <strong><span
                                                id="shelf-item-count">0</span> objekt</strong> till den valda hyllan.
                                    </div>

                                    <div class="d-grid">
                                        <button type="submit" class="btn btn-primary">Flytta objekt</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer will be loaded here -->
    <div id="footer-container"></div>

    <!-- Bootstrap & jQuery JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Custom JS -->
    <script src="namespace.js"></script>
    <script src="mockItems.js"></script>
    <script src="core.js"></script>
    <script src="database.js"></script>
    <script src="admin.js"></script>
    <script src="auth.js"></script>
    <script src="filters.js"></script>

    <script>
        // Load header and footer
        $(document).ready(function () {
            // Load the admin header
            $("#header-container").load("header-admin.html", function () {
                // Check if user is authenticated
                if (!isAuthenticated()) {
                    // User is not authenticated - show login modal
                    showLoginModal();
                } else {
                    // User is authenticated - show welcome message
                    showWelcomeMessage();

                    // Initialize admin functionality
                    initInventorySystem();
                }
            });

            // Load the admin footer
            $("#footer-container").load("footer-admin.html");
        });

        // Initialize inventory system
        function initInventorySystem() {
            // Initialize tabs
            const triggerTabList = [].slice.call(document.querySelectorAll('#inventory-tabs a'));
            triggerTabList.forEach(function (triggerEl) {
                const tabTrigger = new bootstrap.Tab(triggerEl);
                triggerEl.addEventListener('click', function (event) {
                    event.preventDefault();
                    tabTrigger.show();
                });
            });

            // Load initial inventory data
            KarisAntikvariat.Admin.loadInventoryItems(KarisAntikvariat.mockItems);

            // Make rows clickable after initial load
            makeRowsClickable();

            // Set up event handlers for search
            $('#search-btn').click(searchInventoryItems);

            // Handle Enter key press in search field
            $('#search-term').keypress(function (e) {
                if (e.which === 13) {
                    searchInventoryItems();
                }
            });
        }

        // Make rows clickable in the inventory table
        function makeRowsClickable() {
            // Remove existing event handlers to prevent duplicates
            $('#inventory-body tr').off('click');

            // Add click event to inventory rows
            $('#inventory-body tr').click(function () {
                const itemId = $(this).find('td:first').text(); // Get ID from first column
                window.location.href = 'item-admin.html?id=' + itemId;
            });

            // Add hover class for visual feedback
            $('#inventory-body tr').addClass('clickable-row');

            // Apply cursor style directly to ensure it appears
            $('#inventory-body tr').css('cursor', 'pointer');
        }

        // Search items in inventory
        function searchInventoryItems() {
            const searchTerm = $('#search-term').val().toLowerCase();
            const categoryFilter = $('#category-filter').val();

            // Get all items
            let items = [];

            // Check if mockItems is available
            if (window.KarisAntikvariat && window.KarisAntikvariat.mockItems) {
                items = window.KarisAntikvariat.mockItems;
            } else {
                console.warn("Mock items not available, using empty array");
                return;
            }

            // Filter items
            const filteredItems = items.filter(item => {
                const matchesSearch = !searchTerm ||
                    item.title.toLowerCase().includes(searchTerm) ||
                    (item.author && item.author.toLowerCase().includes(searchTerm)) ||
                    item.id.toString().includes(searchTerm);

                const matchesCategory = categoryFilter === 'any' || !categoryFilter ||
                    (item.category && item.category.toLowerCase().includes(categoryFilter.toLowerCase())) ||
                    (item.shelf && item.shelf.toLowerCase().includes(categoryFilter.toLowerCase()));

                return matchesSearch && matchesCategory;
            });

            // Load filtered items into table
            KarisAntikvariat.Admin.loadInventoryItems(filteredItems);

            // Make the newly loaded rows clickable
            makeRowsClickable();
        }
    </script>
</body>

</html>